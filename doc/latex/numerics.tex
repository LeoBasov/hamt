\chapter{Numerics}
\section{Finite Difference Method - FDM}
First order Discritization.
%----------------------------------------------------------------
\begin{equation}
    f'_f = \frac{f_{i+1} - f_i}{\Delta x}
\end{equation}
%----------------------------------------------------------------
\begin{equation}
    f'_b = \frac{f_{i} - f_{i - 1}}{\Delta x}
\end{equation}
%----------------------------------------------------------------
\begin{equation}
    f'_c = \frac{1}{2} \left( f'_f + f'_b \right) = \frac{1}{2} \left( \frac{f_{i+1} - f_i}{\Delta x} + \frac{f_{i} - f_{i - 1}}{\Delta x} \right) \\
    = \frac{f_{i + 1} - f_{i - 1}}{2 \, \Delta x}
\end{equation}
%----------------------------------------------------------------
second order
%----------------------------------------------------------------
\begin{equation}
    f'' = \frac{f'_f - f'_b}{\Delta x} = \frac{f_{i+1} - f_{i}}{\Delta x^2} - \frac{f_{i} - f_{i - 1}}{\Delta x^2} = \frac{f_{i + 1} - 2 \, f_{i} + f_{i-1}}{\Delta x^2}
\end{equation}
%----------------------------------------------------------------
Assuming the differentials $a \, \pdv{f}{x}$ and $a \,\pdv[2]{f}{x}$ where $a$ is not constant.
%----------------------------------------------------------------
\begin{equation}
  \label{eqn:fdm_1}
    a\,f'_c\\
    = \frac{1}{2} \left( \frac{a_{i+1}(f_{i+1} - f_i)}{\Delta x} + \frac{a_{i-1}(f_{i} - f_{i - 1})}{\Delta x} \right) \\
    = \frac{a_{i+1}f_{i + 1} + (a_{i-1} - a_{i+1})f_{i} - a_{i-1}f_{i - 1}}{2 \, \Delta x}
\end{equation}
%----------------------------------------------------------------
%----------------------------------------------------------------
\begin{equation}
  \label{eqn:fdm_2}
    a\,f'' \\
    = a_{i+1}\frac{f_{i+1} - f_{i}}{\Delta x^2} - a_{i-1}\frac{f_{i} - f_{i - 1}}{\Delta x^2} \\
    = \frac{a_{i+1}f_{i + 1} - (a_{i+1} + a_{i-1}) f_{i} + a_{i-1}f_{i-1}}{\Delta x^2}
\end{equation}
%----------------------------------------------------------------

\subsection{Dirichlet Boundary Conditions}
%----------------------------------------------------------------
\begin{equation}
    f\rvert_i = f_0
\end{equation}
%----------------------------------------------------------------

\subsection{Neumann Boundary Conditions}
%----------------------------------------------------------------
\begin{equation}
    \left. \pdv{f}{x} \right|_{x = i} = c
\end{equation}
%----------------------------------------------------------------
%----------------------------------------------------------------
\begin{equation}
    \frac{f_i - f{i - i}}{\Delta x} = c
\end{equation}
%----------------------------------------------------------------
%----------------------------------------------------------------
\begin{equation}
    f_i - f_{i - i}= \Delta x \, c
\end{equation}
%----------------------------------------------------------------

\subsection{Radiation Boundary Conditions}
%----------------------------------------------------------------
\begin{equation}
    \vec{\dot{q}}_r = \epsilon \, \sigma \, T^4 \, \vec n
\end{equation}
%----------------------------------------------------------------
Using the Taylor series
%----------------------------------------------------------------
\begin{equation}
    \mathrm{T} \, f(x;a) = \sum^{\infty}_{n = 0} \frac{f^{(n)}(a)}{n!}(x - a)^n
\end{equation}
%----------------------------------------------------------------
we get the linearized equation for the heat flux due to radiation
%----------------------------------------------------------------
\begin{equation}
    \mathrm{T} \, \dot{q}_r(T;T_0) = (4 \, \epsilon \, \sigma \, T_0^3) T - 3 \, \epsilon \, \sigma \, T_0^4.
\end{equation}
%----------------------------------------------------------------
Using eqation (\ref{eqn:heat_flux})
%----------------------------------------------------------------
\begin{equation}
    -\lambda \pdv{T}{x} = \mathrm{T} \, \dot{q}_r(T;T_0)
\end{equation}
%----------------------------------------------------------------
leads to the discitized, linear equation
%----------------------------------------------------------------
\begin{equation}
    \left( 1 + 4\,k\,T_0^3 \right) T_i - T_{i - 1}= 3\,k\,T_0^4
\end{equation}
%----------------------------------------------------------------
where
%----------------------------------------------------------------
\begin{equation}
    k = \frac{\epsilon\,\sigma\,\Delta x}{\lambda}
\end{equation}
%----------------------------------------------------------------
